function init(){container=document.getElementById("fingerspellingGenerator"),(searchBox=document.getElementById("searchBox")).addEventListener("keydown",onSearch),clock=new THREE.Clock,(camera=new THREE.PerspectiveCamera(30,container.offsetWidth/400,.25,100)).position.set(0,2,2),camera.lookAt(0,0,0),(scene=new THREE.Scene).background=new THREE.Color(14737632),scene.fog=new THREE.Fog(14737632,20,100),(hemiLight=new THREE.HemisphereLight(16777215,4473924)).position.set(0,20,0),scene.add(hemiLight),(dirLight=new THREE.DirectionalLight(16777215)).position.set(0,20,10),scene.add(dirLight),(groundMesh=new THREE.Mesh(new THREE.PlaneGeometry(2e3,2e3),new THREE.MeshPhongMaterial({color:10066329,depthWrite:!1}))).rotation.x=-Math.PI/2,scene.add(groundMesh),(groundGrid=new THREE.GridHelper(200,40,0,0)).material.opacity=.2,groundGrid.material.transparent=!0,scene.add(groundGrid),createGUI(),loadModel("../../assets/3d/right-handed.glb"),(renderer=new THREE.WebGLRenderer({antialias:!0})).setPixelRatio(window.devicePixelRatio),renderer.setSize(container.offsetWidth,400),container.appendChild(renderer.domElement),(controls=new OrbitControls(camera,renderer.domElement)).zoomSpeed=.1,controls.target=new THREE.Vector3(0,1.5,0),controls.update(),window.addEventListener("resize",onWindowResize)}function createGUI(){gui=new GUI({width:100,autoPlace:!1});$(".moveGUI").append($(gui.domElement));rhController=gui.add({"right-handed":!0},"right-handed").onChange(changeRightHanded),lhController=gui.add({"left-handed":!1},"left-handed").onChange(changeLeftHanded),gui.close()}function loadModel(e){(loader=new GLTFLoader).load(e,function(e){model=e.scene,scene.add(model),animations=e.animations,(skeletonHelper=new THREE.SkeletonHelper(model)).material=new THREE.LineBasicMaterial({color:0,linewidth:1,linecap:"round",linejoin:"round"}),skeletonHelper.visible=!0,scene.add(skeletonHelper),prompt=[],currentActionIndex=0,createAnimations()},undefined,function(e){console.error(e)})}function createAnimations(){states=["idle","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],(mixer=new THREE.AnimationMixer(model)).timeScale=1,mixer.addEventListener("finished",playNextAction),actions={};for(let e=0;e<animations.length;e++){const n=animations[e],t=mixer.clipAction(n);actions[n.name]=t,t.clampWhenFinished=!0,t.loop=THREE.LoopOnce}(currentAction=actions.idle).play()}function playNextAction(){currentActionIndex!==prompt.length&&(previousAction=currentAction,currentAction=actions[prompt[currentActionIndex]],previousAction!==currentAction&&previousAction.fadeOut(.5),currentAction.reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(.5).play(),currentActionIndex++)}function onSearch(){if(13===event.keyCode){searchBox.blur(),prompt=[],currentActionIndex=0;const e=searchBox.value,n=/^[a-zA-Z]+$/;for(let t=0;t<e.length;t++)e[t].match(n)&&prompt.push(e[t]);createAnimations()}}function changeRightHanded(e){0==e?(rhController.object={"right-handed":!0},rhController.updateDisplay()):(rhController.object={"right-handed":!0},rhController.updateDisplay(),lhController.object={"left-handed":!1},lhController.updateDisplay(),model.removeFromParent(),skeletonHelper.removeFromParent(),loadModel("../../assets/3d/right-handed.glb"))}function changeLeftHanded(e){0==e?(lhController.object={"left-handed":!0},lhController.updateDisplay()):(lhController.object={"left-handed":!0},lhController.updateDisplay(),rhController.object={"right-handed":!1},rhController.updateDisplay(),model.removeFromParent(),skeletonHelper.removeFromParent(),loadModel("../../assets/3d/left-handed.glb"))}function onWindowResize(){camera.aspect=container.offsetWidth/400,camera.updateProjectionMatrix(),renderer.setSize(container.offsetWidth,400)}function animate(){const e=clock.getDelta();mixer&&mixer.update(e),requestAnimationFrame(animate),renderer.render(scene,camera)}import*as THREE from"three";import{OrbitControls}from"three/addons/controls/OrbitControls.js";import{GLTFLoader}from"three/addons/loaders/GLTFLoader.js";import{GUI}from"three/addons/libs/lil-gui.module.min.js";let container,searchBox,clock,mixer,actions,currentAction,currentActionIndex,previousAction,skeletonHelper,states,camera,controls,hemiLight,dirLight,scene,groundMesh,groundGrid,renderer,loader,model,animations,prompt,gui,rhController,lhController;init(),animate();